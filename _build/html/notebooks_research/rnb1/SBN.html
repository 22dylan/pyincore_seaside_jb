
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spatial Bayesian Network &#8212; Seaside Notebook Gallery</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="References" href="../../ref/ref.html" />
    <link rel="prev" title="IN-CORE Flowchart - Seaside" href="../../notebooks_demonstrative/dnb3/Notebook1_Seaside.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/resilience_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Seaside Notebook Gallery</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Seaside Notebook Gallery
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Demonstrative Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks_demonstrative/dnb1/Seaside_testbed.html">
   Building Damage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks_demonstrative/dnb2/Seaside_CommDescription.html">
   Community Description
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks_demonstrative/dnb3/Notebook1_Seaside.html">
   IN-CORE Flowchart - Seaside
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Research Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Spatial Bayesian Network
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ref/ref.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks_research/rnb1/SBN.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks_research/rnb1/SBN.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-bayesian-network-structure">
     Single Bayesian Network Structure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-prerequisites">
     Code Prerequisites
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-instructions">
   Run Instructions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sbn-input-options">
     SBN Input Options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-code">
   Running Code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-the-sbn">
     Running the SBN
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-results">
   Plotting Results
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="spatial-bayesian-network">
<h1>Spatial Bayesian Network<a class="headerlink" href="#spatial-bayesian-network" title="Permalink to this headline">¶</a></h1>
<p>This notebook demonstrates the use of a spatial Bayesian network (SBN) to evaluate parcel-level resilience. The SBN is applied to Seaside, Oregon and evaluates resilience against a cascading seismic-tsunami hazard. The process to develop the spatial Bayesian network is comprised of four steps:</p>
<ol class="simple">
<li><p><ins>Damage infrastructure using pyIncore</ins> - Damage codes were developed to damage four infrastructure systems in Seaside (buildings, electric, transportation, and water). Where applicable, these damage codes used pyIncore.</p></li>
<li><p><ins>Develop operability curves and populate conditional probability tables (CPTs)</ins> - The results from the damage analysis were used to generate operability curves. Statistics on the operability curves were extracted to populate the CPTs</p></li>
<li><p><ins>Generate the SBN</ins> - A Bayesian network was constructed at each parcel using the resulting CPTs.</p></li>
<li><p><ins>Generate parcel-level maps of resilience</ins> - The SBN can then be used as a decision support tool to evaluate parcel-level resilience.</p></li>
</ol>
<p>This entire process is outlined in the figure below. This notebook, however, demonstrates the final two steps highlighted in red. That is, a spatial Bayesian network is constructed and it is used to generate maps of resilience.</p>
<p><img alt="SBN Process" src="../../_images/framework.png" /><br></p>
<p>The codes used for the first two steps are located in the “dev_code/” directory and consist of the following python files:</p>
<ul class="simple">
<li><p><ins>damage_building.py</ins> - damages building infrastructure and repair time analysis.</p></li>
<li><p><ins>damage_electric.py</ins> - damages electric infrastructure, connectivity analysis, repair time analysis.</p></li>
<li><p><ins>damage_transportation.py</ins> - damages transportation infrastructure, connectivity analysis, repair time analysis.</p></li>
<li><p><ins>damage_water.py</ins> - damages water infrastructure, connectivity analysis, repair time analysis.</p></li>
<li><p><ins>CPTsH5.py</ins> - populates CPTs using results from the above</p></li>
</ul>
<p>This notebook is associated with the following journal paper:</p>
<blockquote>
<div><p>Sanderson, D., Cox, D., and Naraharisetty, G. (2021). A spatially explicit decision support framework for parcel-and community-level resilience assessment using Bayesian networks. <em>Sustainable and Resilient Infrastructure</em>. <a class="reference external" href="https://doi.org/10.1080/23789689.2021.1966164">https://doi.org/10.1080/23789689.2021.1966164</a></p>
</div></blockquote>
<p>*Notebook created by Dylan R. Sanderson (OSU - <a class="reference external" href="mailto:sanderdy&#37;&#52;&#48;oregonstate&#46;edu">sanderdy<span>&#64;</span>oregonstate<span>&#46;</span>edu</a>)<br></p>
<hr class="docutils" />
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<div class="section" id="single-bayesian-network-structure">
<h3>Single Bayesian Network Structure<a class="headerlink" href="#single-bayesian-network-structure" title="Permalink to this headline">¶</a></h3>
<p>Each parel is assigned a Bayesian network with unique CPTs. The structure of a single parcel’s Bayesian network is shown below. The top two layers correspond to community (blue) and parcel (green) level decisions. Functionality and repair time nodes are generated for each infrastructure system, and correspond to the operability curves. The functionality and repair time targets are used to specify a desired performance level. And the final layer is the parcel’s Robustness, Rapidity, and Resilience.</p>
<!-- ![title](images/SBN.png)<br> -->
<img src="images/SBN.png" width="600"/></div>
<hr class="docutils" />
<div class="section" id="code-prerequisites">
<h3>Code Prerequisites<a class="headerlink" href="#code-prerequisites" title="Permalink to this headline">¶</a></h3>
<p>The following python modules are necessary to run this notebook. Modules were installed through conda-forge on the author’s computer under the following versions.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Module</p></th>
<th class="head"><p>Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pyIncore</p></td>
<td><p>0.6.3</p></td>
<td><p>see: <a class="reference external" href="https://incore.ncsa.illinois.edu/">https://incore.ncsa.illinois.edu/</a></p></td>
</tr>
<tr class="row-odd"><td><p>pandas</p></td>
<td><p>1.0.3</p></td>
<td><p>used for data organization</p></td>
</tr>
<tr class="row-even"><td><p>geopandas</p></td>
<td><p>0.6.1</p></td>
<td><p>used for working with geospatial data</p></td>
</tr>
<tr class="row-odd"><td><p>ipyleaflet</p></td>
<td><p>0.13.0</p></td>
<td><p>used for geospatial visualization</p></td>
</tr>
<tr class="row-even"><td><p>ipywidgets</p></td>
<td><p>7.5.1</p></td>
<td><p>used for interacting with geospatial results</p></td>
</tr>
<tr class="row-odd"><td><p>branca</p></td>
<td><p>0.3.1</p></td>
<td><p>used in geospatial visualization</p></td>
</tr>
<tr class="row-even"><td><p>h5py</p></td>
<td><p>2.10.0</p></td>
<td><p>used to interact with hdf5 file</p></td>
</tr>
<tr class="row-odd"><td><p>pomegranate</p></td>
<td><p>0.11.1</p></td>
<td><p>Bayesian network module</p></td>
</tr>
<tr class="row-even"><td><p>numpy</p></td>
<td><p>1.18.1</p></td>
<td><p>working with matrices and arrays</p></td>
</tr>
<tr class="row-odd"><td><p>map_creation_backend.py*</p></td>
<td><p>-</p></td>
<td><p>backend code used for geospatial visualization</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://BN.py">BN.py</a>*</p></td>
<td><p>-</p></td>
<td><p>backend used to construct SBN</p></td>
</tr>
</tbody>
</table>
<p>*backend code written by the author</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="run-instructions">
<h2>Run Instructions<a class="headerlink" href="#run-instructions" title="Permalink to this headline">¶</a></h2>
<p><strong>To run this notebook:</strong></p>
<ol class="simple">
<li><p>Download the CPT h5 file at:. <br></p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://oregonstate.box.com/s/xzql2dhgzp7utqhcobgjyi9bitwnulq1">https://oregonstate.box.com/s/xzql2dhgzp7utqhcobgjyi9bitwnulq1</a>.</p>
</div></blockquote>
<ol class="simple">
<li><p>Ensure that the CPT h5 file is in the same directory as this notebook. <br></p></li>
<li><p>Modify/setup the input data. Two input files are required and examples are provided in this repository: <br>
i. Community-level decisions (cmty_input.csv) <br>
ii. Parcel-level decisions (prcl_input.csv) <br></p></li>
<li><p>Run each cell in this notebook.</p></li>
</ol>
<div class="section" id="sbn-input-options">
<h3>SBN Input Options<a class="headerlink" href="#sbn-input-options" title="Permalink to this headline">¶</a></h3>
<p>The community- and parcel-level decisions are specified below. Community-level decisions are boxed in blue and correspond to the blue nodes in the Bayesian network. Parcel-level decisions are boxed in green and correspond to the green nodes in the Bayesian network. These are defined in the two input files.</p>
<img src="images/input_options.png" width="500"/></div>
</div>
<hr class="docutils" />
<div class="section" id="running-code">
<h2>Running Code<a class="headerlink" href="#running-code" title="Permalink to this headline">¶</a></h2>
<p><strong>Importing required modules for this notebook</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">ctx</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>

<span class="kn">from</span> <span class="nn">pyincore</span> <span class="kn">import</span> <span class="n">IncoreClient</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataService</span>
<span class="kn">from</span> <span class="nn">dev_code.BN</span> <span class="kn">import</span> <span class="n">Building_BN</span><span class="p">,</span> <span class="n">Seaside_buildings_BN</span>
<span class="kn">from</span> <span class="nn">dev_code.map_creation_backend</span> <span class="kn">import</span> <span class="n">map_creation_backend</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Specifying required paths and data locations</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prcl_input</span> <span class="o">=</span> <span class="s1">&#39;prcl_input.csv&#39;</span> <span class="c1"># input parcel filename</span>
<span class="n">cmty_input</span> <span class="o">=</span> <span class="s1">&#39;cmty_input.csv&#39;</span> <span class="c1"># input community filename</span>
<span class="n">outfile_name</span> <span class="o">=</span> <span class="s1">&#39;SBNo.csv&#39;</span>     <span class="c1"># output filename</span>
<span class="n">n_parcels</span> <span class="o">=</span> <span class="mi">4769</span>               <span class="c1"># number of parcels to evaluate (0-4769)</span>
<span class="n">n_process</span> <span class="o">=</span> <span class="mi">4</span>                 <span class="c1"># number of processes to divide code into (runs in parallel)</span>

<span class="n">cpt_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;CPTs.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Reading in data and printing some information</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">cpt_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">guids</span> <span class="o">=</span> <span class="n">guids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_parcels</span><span class="p">]</span>

<span class="n">prcl_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">prcl_input</span><span class="p">)</span>
<span class="n">prcl_data</span> <span class="o">=</span> <span class="n">prcl_data</span><span class="p">[</span><span class="n">prcl_data</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">guids</span><span class="p">)]</span>
<span class="n">cmty_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cmty_input</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-sbn">
<h3>Running the SBN<a class="headerlink" href="#running-the-sbn" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SBBN</span> <span class="o">=</span> <span class="n">Seaside_buildings_BN</span><span class="p">(</span><span class="n">cpt_path</span><span class="p">)</span>

<span class="c1"># --- evaluating BNs</span>
<span class="n">out_data</span> <span class="o">=</span> <span class="n">SBBN</span><span class="o">.</span><span class="n">evaluate_BNs</span><span class="p">(</span><span class="n">input_data_bldg</span> <span class="o">=</span> <span class="n">prcl_data</span><span class="p">,</span> 
                            <span class="n">input_data_cmty</span> <span class="o">=</span> <span class="n">cmty_data</span><span class="p">,</span>
                            <span class="n">n_process</span> <span class="o">=</span> <span class="n">n_process</span><span class="p">,</span>
                            <span class="n">outfilename</span> <span class="o">=</span> <span class="n">outfile_name</span><span class="p">,</span> 
                            <span class="n">write_out</span><span class="o">=</span><span class="kc">True</span>
                            <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-results">
<h2>Plotting Results<a class="headerlink" href="#plotting-results" title="Permalink to this headline">¶</a></h2>
<p>This portion of the notebook plots the results spatially in an interactive map. Each parcel is color coded according to it’s robustness, rapidity, or resilience.</p>
<img src="images/colorbar.png" width="500"/><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reading in results</span>
<span class="n">result_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;SBNo.csv&#39;</span><span class="p">)</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">result_file</span><span class="p">)</span>
<span class="n">result_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># reading in polygon layer for plotting</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">IncoreClient</span><span class="p">()</span>
<span class="n">data_service</span> <span class="o">=</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">bldg_inventory_id</span> <span class="o">=</span> <span class="s1">&#39;5d927ab2b9219c06ae8d313c&#39;</span> <span class="c1"># polygons</span>
<span class="n">bldg_ds</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">bldg_inventory_id</span><span class="p">,</span> <span class="n">data_service</span><span class="p">)</span>
<span class="n">bldg_df</span> <span class="o">=</span> <span class="n">bldg_ds</span><span class="o">.</span><span class="n">get_dataframe_from_shapefile</span><span class="p">()</span>
<span class="n">bldg_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">bldg_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">bldg_df</span><span class="p">,</span> <span class="n">result_df</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connection successful to IN-CORE services. pyIncore version detected: 1.0.0
Dataset already exists locally. Reading from local cached zip.
Unzipped folder found in the local cache. Reading from it...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">bldg_df</span> <span class="o">=</span> <span class="n">bldg_df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>

<span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">bldg_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
              <span class="n">column</span><span class="o">=</span><span class="s1">&#39;resilience&#39;</span><span class="p">,</span>
              <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
              <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">OpenStreetMap</span><span class="o">.</span><span class="n">Mapnik</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/SBN_15_0.png" src="../../_images/SBN_15_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks_research/rnb1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../../notebooks_demonstrative/dnb3/Notebook1_Seaside.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">IN-CORE Flowchart - Seaside</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../../ref/ref.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">References</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dylan Sanderson<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>